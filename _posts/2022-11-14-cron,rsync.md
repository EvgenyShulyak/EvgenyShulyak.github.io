---
layout: post
title:  cron and rsync
categories: News Linux Program
---


#### *Есть много полезных консольных команд и приложений.Приведу здесь две пожалуй самые необходимые консольные программы:*

### cron

#### *Если в двух словах,*  **Cron** – *это планировщик задач*.

>crontab -e – открывает конфигурационный файл

>crontab -l – показывает список задач из конфигурационного файла (все, что было запланировано).

>crontab -r – удаляет конфигурационный файл вместе со всеми запланированными задачами.

>сrontab -v – показывает, когда в последний раз открывался конфигурационный файл.

##### crontab -e   создать задание(работает от имени пользователя,без sudo)

##### На моем примере: #####

- 00 09 16 * * echo 'date' > /home/user/Desktop/date.txt

 *(Расшифровка: в ноль минут,в девять часов,шестнадцатого числа,каждый месяц отпралять сообщение 
 со словом data оправлять на рабочий стол,в файл data.txt.)*

#### Если нужно по расписанию проиграть звуковой файл.

- 00 08 * * * /usr/bin/mpg123  /home/jenit/Music/mahnem.mp3

*(Расшифровка: в ноль минут,в восемь часов,каждый день будет звучать эта музыка.)*


***Проверить установлен ли проигрыватель mpg123 командой:***

- which mpg123 

***вывод должен быть:***

- /usr/bin/mpg123

***иначе установить.*** 

#### cron, почта.

 Вы можете получать сообщения об ошибках при выполнении программ, чтобы полностью контролировать 
 работу периодически запускаемых заданий. Для этого в начале cron-сценария поместите такую строку:

> MAILTO=адрес@домен.ru, где «адрес@домен.ru»

  — *это адрес электронной почты, куда придут уведомления. Чтобы указать несколько адресов, 
  введите их через запятую*.
 
 Вы будете получать письмо с тем, что выводят скрипты каждый раз, когда cron запускает задачу. 
  Если вы напишете скрипт, который будет печатать строчку **«Hello, world»** и поставите его на 
  выполнение через cron — вы будете получать письмо со строкой **«Hello, world»** каждый раз, 
 когда cron запустит такой скрипт.

### rsync  

***Это мощная утилита для быстрого, гибкого удаленного и локального копирования файлов.***

#### Синтаксис утилиты простой. ####

- **rsync -options source destination**

>**options — параметры, с которыми должна выполняться утилита.**

>**source— каталог или файл, который является источником.**

> **destination — каталог или файл, который является приемником.**

##### Опять же на моем примере - резервное копирование корневого раздела в домашнюю директорию.Кореневой и домашний должны быть на разных раделах или дисках.Опции описывать не буду.Их можно посмотреть командой  *rsync --help* #####

##### rsync -aAXvzh / --exclude={"/home/*","/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found"} /home/jenit/2022-08-13 #####

***Эту команду нужно выполнять из под sudo.У меня rsync настроен на работу без sudo.У Вас это будет так:***

##### sudo rsync -aAXvzh / --exclude={"/home/*","/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found"} /home/jenit/2022-08-13 #####

 * Без sudo: 

нужно отредактировать **/etc/sudoers** и позволить одному юзеру запускать твой файл с привелегиями рута
Файл обязательно нужно запретить редактировать данному юзеру

> * Allow members of group sudo to execute any command
>
>* (Разрешить членам группы sudo выполнять любую команду)

> %sudo ALL=(ALL:ALL) ALL
> user ALL = NOPASSWD: /home/user/Documents/script.sh

**Для восстановления поменять каталоги местами (приемник-источник).**
